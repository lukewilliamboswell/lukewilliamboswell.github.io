<!DOCTYPE html><html  lang="en"><head><title>Roc Examples</title><meta  charset="utf-8"></meta><meta  name="viewport" content="width=device-width"></meta><link  rel="icon" href="/favicon.svg"></link><link  rel="stylesheet" href="/styles.css"></link><script  type="text/javascript" src="/copy-btn.js" defer=""></script></head><body><div  class="top-header-extension"></div><header  class="top-header"><div  class="pkg-and-logo"><a  class="logo" href="/"><svg  viewBox="0 -6 51 58" fill="none" xmlns="http://www.w3.org/2000/svg" aria-labelledby="logo-link" role="img"><title  id="logo-link">Return to Roc packages</title><polygon  role="presentation" points="0,0 23.8834,3.21052 37.2438,19.0101 45.9665,16.6324 50.5,22 45,22 44.0315,26.3689 26.4673,39.3424 27.4527,45.2132 17.655,53 23.6751,22.7086"></polygon></svg></a><h1  class="pkg-full-name"><a  href="/index.html">Examples</a></h1></div><div  class="top-header-triangle"></div></header><p  class="feedback">we ðŸ’œ feedback: <a  href="https://github.com/roc-lang/examples">GitHub</a> | <a  href="https://roc.zulipchat.com/">Group Chat</a></p><main><h1>Json</h1>
<p>A basic example which shows how to de-serialise data from json using the <code>Decode</code> ability.</p>
<h2>Output</h2>
<pre><samp>% roc run examples/JsonBasic/main.roc
Successfully decoded image, title:"View from 15th Floor"
</pre></samp>
<h2>Code</h2>
<pre><samp><span class="kw">app</span><span class="literal"> "json-basic"</span><span class="kw">
    packages</span><span class="delimeter"> {</span><span class="lowerident">
        cli</span><span class="kw">:</span><span class="literal"> "https://github.com/roc-lang/basic-cli/releases/download/0.5.0/Cufzl36_SnJ4QbOoEmiJ5dIpUxBvdB3NEySvuH82Wio.tar.br"</span><span class="delimeter">,</span><span class="lowerident">
        json</span><span class="kw">:</span><span class="literal"> "https://github.com/lukewilliamboswell/roc-json/releases/download/v0.3.0/y2bZ-J_3aq28q0NpZPjw0NC6wghUYFooJpH03XzJ3Ls.tar.br"</span><span class="delimeter">,</span><span class="delimeter">
    }</span><span class="kw">
    imports</span><span class="delimeter"> [</span><span class="lowerident">
        cli</span><span class="delimeter">.</span><span class="upperident">Stdout</span><span class="delimeter">,</span><span class="lowerident">
        cli</span><span class="delimeter">.</span><span class="upperident">Task</span><span class="delimeter">,</span><span class="lowerident">
        json</span><span class="delimeter">.</span><span class="upperident">Core</span><span class="delimeter">.</span><span class="delimeter">{</span><span class="lowerident"> jsonWithOptions</span><span class="delimeter"> }</span><span class="delimeter">,</span><span class="upperident">
        Decode</span><span class="delimeter">.</span><span class="delimeter">{</span><span class="upperident"> DecodeResult</span><span class="delimeter">,</span><span class="lowerident"> fromBytesPartial</span><span class="delimeter"> }</span><span class="delimeter">,</span><span class="delimeter">
    ]</span><span class="kw">
    provides</span><span class="delimeter"> [</span><span class="lowerident">main</span><span class="delimeter">]</span><span class="kw"> to</span><span class="lowerident"> cli</span><span class="lowerident">

main</span><span class="kw"> =</span><span class="lowerident">
    requestBody</span><span class="kw"> =</span><span class="upperident"> Str</span><span class="delimeter">.</span><span class="lowerident">toUtf8</span><span class="literal"> "{\"Image\":{\"Animated\":false,\"Height\":600,\"Ids\":[116,943,234,38793],\"Thumbnail\":{\"Height\":125,\"Url\":\"http:\\/\\/www.example.com\\/image\\/481989943\",\"Width\":100},\"Title\":\"View from 15th Floor\",\"Width\":800}}"</span><span class="lowerident">

    decoder</span><span class="kw"> =</span><span class="lowerident"> jsonWithOptions</span><span class="delimeter"> {</span><span class="lowerident"> fieldNameMapping</span><span class="kw">:</span><span class="upperident"> PascalCase</span><span class="delimeter"> }</span><span class="lowerident">

    decoded</span><span class="kw"> :</span><span class="upperident"> DecodeResult</span><span class="upperident"> ImageRequest</span><span class="lowerident">
    decoded</span><span class="kw"> =</span><span class="lowerident"> fromBytesPartial</span><span class="lowerident"> requestBody</span><span class="lowerident"> decoder</span><span class="kw">

    when</span><span class="lowerident"> decoded</span><span class="delimeter">.</span><span class="lowerident">result</span><span class="kw"> is</span><span class="upperident">
        Ok</span><span class="lowerident"> record</span><span class="kw"> -&gt;</span><span class="upperident">
            Stdout</span><span class="delimeter">.</span><span class="lowerident">line</span><span class="literal"> "Successfully decoded image, title:\"\(record.image.title)\""</span><span class="upperident">
        
        Err</span><span class="lowerident"> _</span><span class="kw"> -&gt;</span><span class="delimeter">
            {</span><span class="delimeter">}</span><span class="kw"> &lt;-</span><span class="upperident"> Stdout</span><span class="delimeter">.</span><span class="lowerident">line</span><span class="literal"> "Error, failed to decode image"</span><span class="kw"> |&gt;</span><span class="upperident"> Task</span><span class="delimeter">.</span><span class="lowerident">await</span><span class="upperident">

            Task</span><span class="delimeter">.</span><span class="lowerident">err</span><span class="literal"> 1</span><span class="comment"> # 1 is an exit code to indicate failure</span><span class="upperident">

ImageRequest</span><span class="kw"> :</span><span class="delimeter"> {</span><span class="lowerident">
    image</span><span class="kw"> :</span><span class="delimeter"> {</span><span class="lowerident">
        width</span><span class="kw"> :</span><span class="upperident"> I64</span><span class="delimeter">,</span><span class="lowerident">
        height</span><span class="kw"> :</span><span class="upperident"> I64</span><span class="delimeter">,</span><span class="lowerident">
        title</span><span class="kw"> :</span><span class="upperident"> Str</span><span class="delimeter">,</span><span class="lowerident">
        thumbnail</span><span class="kw"> :</span><span class="delimeter"> {</span><span class="lowerident">
            url</span><span class="kw"> :</span><span class="upperident"> Str</span><span class="delimeter">,</span><span class="lowerident">
            height</span><span class="kw"> :</span><span class="upperident"> F32</span><span class="delimeter">,</span><span class="lowerident">
            width</span><span class="kw"> :</span><span class="upperident"> F32</span><span class="delimeter">,</span><span class="delimeter">
        }</span><span class="delimeter">,</span><span class="lowerident">
        animated</span><span class="kw"> :</span><span class="upperident"> Bool</span><span class="delimeter">,</span><span class="lowerident">
        ids</span><span class="kw"> :</span><span class="upperident"> List</span><span class="upperident"> U32</span><span class="delimeter">,</span><span class="delimeter">
    }</span><span class="delimeter">,</span><span class="delimeter">
}</span></samp></pre></main><footer><p>Made by people who like to make nice things Â© 2023</p></footer></body></html>